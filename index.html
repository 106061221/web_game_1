<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>實體工具大師</title>
    <style>
        body { margin: 0; background: #1a1a1a; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; touch-action: none; }
        canvas { background: #222; border: 5px solid #333; box-shadow: inset 0 0 30px #000; cursor: grab; }
    </style>
</head>
<body>
<canvas id="g" width="380" height="600"></canvas>
<script>
const cvs = document.getElementById('g'), ctx = cvs.getContext('2d');
let pieces = [
    { name: 'Hammer', x: 50, y: 450, tx: 90, ty: 80, w: 180, h: 60, color: '#888' },
    { name: 'Wrench', x: 200, y: 500, tx: 100, ty: 200, w: 150, h: 40, color: '#aaa' }
];
let active = null, off = { x: 0, y: 0 };

function drawTool(p, isShadow = false) {
    ctx.save();
    ctx.translate(p.x, p.y);
    if (isShadow) { ctx.filter = 'brightness(0)'; ctx.globalAlpha = 0.3; }
    else {
        ctx.shadowColor = 'rgba(0,0,0,0.5)'; ctx.shadowBlur = 10; ctx.shadowOffsetY = 5;
    }

    if (p.name === 'Hammer') {
        // 鎚頭：金屬漸層
        let g = ctx.createLinearGradient(0, 0, 60, 0);
        g.addColorStop(0, '#444'); g.addColorStop(0.5, '#eee'); g.addColorStop(1, '#444');
        ctx.fillStyle = g;
        ctx.fillRect(0, 0, 60, 40); // 鎚頭主體
        ctx.fillStyle = '#b52'; // 木柄
        ctx.fillRect(20, 40, 20, 100); 
    } else if (p.name === 'Wrench') {
        // 扳手：鋼鐵質感
        ctx.fillStyle = '#999';
        ctx.fillRect(30, 10, 100, 20); // 柄
        ctx.beginPath(); ctx.arc(30, 20, 20, 0, 7); ctx.fill(); // 頭
        ctx.clearRect(15, 15, 15, 10); // 扳手開口
    }
    ctx.restore();
}

function render() {
    ctx.clearRect(0, 0, cvs.width, cvs.height);
    // 畫凹槽
    pieces.forEach(p => { 
        let temp = {...p, x: p.tx, y: p.ty};
        drawTool(temp, true);
    });
    // 畫實體
    pieces.forEach(p => drawTool(p));
    requestAnimationFrame(render);
}

cvs.onmousedown = e => {
    const r = cvs.getBoundingClientRect(), px = e.clientX - r.left, py = e.clientY - r.top;
    active = pieces.find(p => px > p.x && px < p.x + p.w && py > p.y && py < p.y + p.h);
    if (active) { off.x = px - active.x; off.y = py - active.y; }
};
window.onmousemove = e => {
    if (active) {
        const r = cvs.getBoundingClientRect();
        active.x = e.clientX - r.left - off.x;
        active.y = e.clientY - r.top - off.y;
    }
};
window.onmouseup = () => {
    if (active) {
        if (Math.abs(active.x - active.tx) < 20 && Math.abs(active.y - active.ty) < 20) {
            active.x = active.tx; active.y = active.ty;
        }
        active = null;
    }
};
render();
</script>
</body>
</html>
